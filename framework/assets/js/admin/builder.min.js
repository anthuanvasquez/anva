JSON.stringify=JSON.stringify||function(t){var e=typeof t;if("object"!=e||null===t)return"string"==e&&(t='"'+t+'"'),String(t);var i,n,r=[],a=t&&t.constructor==Array;for(i in t)n=t[i],e=typeof n,"string"==e?n='"'+n+'"':"object"==e&&null!==n&&(n=JSON.stringify(n)),r.push((a?"":'"'+i+'":')+String(n));return(a?"[":"{")+String(r)+(a?"]":"}")},function(t){var e=jQuery.now();t("#tabs-1 ul li").draggable({connectToSortable:"#content_builder_sort",cursor:"move",revert:"invalid",helper:function(){var i,n=t("#ppb_options"),r=t("#ppb_options_title"),a=t("#ppb_options_image");if(randomId=e,myCheckId=n.val(),myCheckTitle=r.val(),postType=t("#ppb_post_type").val(),myImage=a.val(),""!=myCheckId){var l={};l.id=randomId,l.shortcode=myCheckId,l.ppb_text_title=myCheckTitle,l.ppb_text_content="",l.ppb_header_content="";var o=(JSON.stringify(l),ANVA.ajaxurl+"?action=pp_ppb&ppb_post_type="+postType+"&shortcode="+myCheckId+"&rel="+randomId);builderItem='<li id="'+randomId+'" class="item item-'+randomId+" "+myCheckId+' ui-state-default one" data-current-size="one">',builderItem+='<div class="actions">',builderItem+='<a href="'+o+'" class="ppb_edit" data-rel="'+randomId+'"></a>',builderItem+='<a href="#" class="ppb_remove"></a>',builderItem+="</div>",builderItem+='<div class="thumbnail">',builderItem+='<img src="'+myImage+'" alt="'+myCheckTitle+'" />',builderItem+="</div>",builderItem+='<div class="title">',builderItem+='<span class="shortcode-type">'+myCheckTitle+"</span>",builderItem+='<span class="shortcode-title"></span>',builderItem+="</div>",builderItem+='<input type="hidden" class="ppb_setting_columns" value="one_fourth"/>',builderItem+='<div class="clear"></div>',builderItem+="</li>",i=builderItem}return i},start:function(t,e){},stop:function(t,e){}}),t("#ppb_export_current_button").on("click",function(){t("#ppb_export_current").val(1)}),t("#ppb_import_current_button").on("click",function(){t("#ppb_import_current").val(1)}),t("#modules-tabs, #export-tabs").tabs({hide:{effect:"fade",duration:400},show:{effect:"fade",duration:400}}),t(".builder-sortable-items").sortable({placeholder:"ui-state-highlight",revert:!0}),t(".builder-sortable-items").disableSelection();var i=t(".builder-modules li");i.on("click",function(e){e.preventDefault(),i.removeClass("selected"),t(this).addClass("selected");var n=t(this).data("module"),r=t(this).data("title"),a=t(this).find("img").attr("src");t("#ppb_options").val(n),t("#ppb_options_title").val(r),t("#ppb_options_image").val(a)}),t("#add-builder-item").on("click",function(e){e.preventDefault();var i=t("#ppb_options"),n=t("#ppb_options_title"),r=t("#ppb_options_image");if(""==i.val())return alert(ANVA.builder_empty_options),!1;if(randomId=jQuery.now(),myCheckId=i.val(),myCheckTitle=n.val(),postType=t("#ppb_post_type").val(),myImage=r.val(),""!=myCheckId){var a={};a.id=randomId,a.shortcode=myCheckId,a.ppb_text_title=myCheckTitle,a.ppb_text_content="",a.ppb_header_content="";var l=JSON.stringify(a),o=ANVA.ajaxurl+"?action=pp_ppb&ppb_post_type="+postType+"&shortcode="+myCheckId+"&rel="+randomId;builderItem='<li id="'+randomId+'" class="item-'+myCheckId+' ui-state-default one" data-current-size="one">',builderItem+='<div class="actions">',builderItem+='<a href="'+o+'" class="ppb_edit" data-rel="'+randomId+'"></a>',builderItem+='<a href="#" class="ppb_remove"></a>',builderItem+="</div>",builderItem+='<div class="thumbnail">',builderItem+='<img src="'+myImage+'" alt="'+myCheckTitle+'" />',builderItem+="</div>",builderItem+='<div class="title">',builderItem+='<span class="shortcode-type">'+myCheckTitle+"</span>",builderItem+='<span class="shortcode-title"></span>',builderItem+="</div>",builderItem+='<span class="spinner spinner-'+randomId+'"></span>',builderItem+='<input type="hidden" class="ppb_setting_columns" value="one_fourth"/>',builderItem+='<div class="clear"></div>',builderItem+="</li>",t("#content_builder_sort").append(builderItem),t("#content_builder_sort").removeClass("empty"),t("#"+randomId).data("ppb_setting",l),"ppb_divider"!=myCheckId&&"ppb_empty_line"!=myCheckId&&t("#"+randomId).find(".ppb_edit").trigger("click"),t("html, body").animate({scrollTop:t("#"+randomId).offset().top-32},1e3)}}),t(document).on("click","#content_builder_sort li a.ppb_remove",function(e){e.preventDefault();var i=t(this).parent(".actions").parent("li");confirm("Are you sure you want to delete this item?")&&(i.remove(),setTimeout(function(){0==t("#content_builder_sort li").length&&t("#content_builder_sort").addClass("empty")},500))}),t(document).on("click","#content_builder_sort li .actions a.ppb_edit",function(e){e.preventDefault();var i=t(this).parent(".actions").parent("li"),n=i.attr("id"),r=t("#item-inner-"+n);if(0==r.length){t("#ppb_inline_current").attr("value",t(this).attr("data-rel"));var a=t(this).attr("href");i.find("span.spinner").css("visibility","visible");var l=t.ajax({type:"GET",cache:!1,url:a,data:"",success:function(e){i.append('<div id="item-inner-'+n+'" class="item-inner item-inner-'+n+'" style="display:none;">'+e+"</div>"),t("#"+n).addClass("has-inline-content")}});t.when(l).then(function(){t("#item-inner-"+n).slideToggle(),i.find("span.spinner").css("visibility","hidden"),t("#ppb_inline :input").each(function(){"undefined"!=typeof t(this).attr("id")&&t(this).attr("value","")}),t(".colorpicker").wpColorPicker(),t(".rangeslider").change(function(){var e,i;e=t(this),width=e.width(),i=(e.val()-e.attr("min"))/(e.attr("max")-e.attr("min")),e.next("output").text(e.val())}).trigger("change"),t(".builder-sortable-items").enableSelection(),t("html, body").animate({scrollTop:t("#"+n).offset().top-32},1e3)})}else t("#item-inner-"+n).slideToggle()}),t(document).on("click",".metabox_upload_btn",function(e){var i="";i=t(this).attr("rel");var n=wp.media.editor.send.attachment;return wp.media.editor.send.attachment=function(e,r){t("#"+i).attr("value",r.url),t('<img src="'+r.url+'" />').insertAfter("#"+i+"_button"),wp.media.editor.send.attachment=n},wp.media.editor.open(),!1}),t("#publish").on("click",function(e){t("#content_builder_sort > li").each(function(){t(this).append('<textarea style="display:none" id="'+t(this).attr("id")+'_data" name="'+t(this).attr("id")+'_data">'+t(this).data("ppb_setting")+"</textarea>"),t(this).append('<input style="display:none" type="text" id="'+t(this).attr("id")+'_size" name="'+t(this).attr("id")+'_size" value="'+t(this).attr("data-current-size")+'"/>')});var i=t("#content_builder_sort").sortable("toArray");t("#ppb_form_data_order").attr("value",i)}),t("body").on("click","#wp-link-submit",function(e){var i=wpLink.getAttrs();return t("#"+wpLink.inputid).val(i.href),wpLink.textarea=t("body"),wpLink.close(),e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation(),!1}),t("body").on("click","#wp-link-cancel, #wp-link-close",function(e){return wpLink.textarea=t("body"),wpLink.close(),e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation(),!1})}(jQuery);